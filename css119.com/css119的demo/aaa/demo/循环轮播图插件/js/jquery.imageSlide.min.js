;(function(b){function a(d,e){var c=this;c.wrap=d;c.ul=c.wrap.find(e.ul);c.li=c.ul.find(e.li);c.len=c.li.length;c.liWidth=c.li.outerWidth(true);c.liHeight=c.li.outerHeight(true);c.numBox=c.wrap.find(e.numBox);c.prev=c.wrap.find(e.prev);c.next=c.wrap.find(e.next);c.isAuto=e.isAuto;c.lazyLoad=e.lazyLoad;c.imgSrc=e.imgSrc;c.isLoadJSON=e.isLoadJSON;c.LoadJsonObj=e.LoadJsonObj;c.isLoop=e.isLoop;c.disable=e.disable;c.hotKey=e.hotKey;c.displayNum=e.displayNum;c.cur=e.cur;c.evt=e.evt;c.effect=e.effect;c.slideType=e.slideType;c.speed=e.speed;c.autoTime=e.autoTime;c.index=e.index;c.numBoxB=null;c.timer=null;c.timer2=null;c.direction=null;c.step=null;c.dbclicks=false;c.moveObj={};c.moveObj2={};c.prevIndex=0;c.init()}a.prototype={init:function(){var c=this;c.isLoadJSONFun();c.config();c.autoPlay();c.hotKeyFun();c.bind()},config:function(){var d=this;d.speed=d.speed>=d.autoTime?d.autoTime-100:d.speed;if(d.index<=0){d.index=0}else{if(d.index>=d.len){d.index=d.len-1}}if(d.displayNum){d.numBox.empty();for(var c=0;c<d.len;c++){d.numBox.append("<b>"+(c+1)+"</b>")}}d.numBoxB=d.numBox.children();d.numBoxB.eq(d.index).addClass(d.cur);if(d.lazyLoad){for(var e=0;e<d.len;e++){d.li.eq(e).append("<div class='loading-cover'></div>")}}!d.isLoop&&d.index==0&&d.prev.addClass(d.disable[0]);!d.isLoop&&d.index==d.len-1&&d.next.addClass(d.disable[1]);d.lazyLoad&&d.loadImg(d.index);switch(d.effect){case 0:d.li.hide().eq(d.index).show();break;case 1:d.direction="left";d.step=d.liWidth;break;case 2:d.direction="top";d.step=d.liHeight;break}if(d.effect!=0){d.li.css(d.direction,d.step).eq(d.index).css(d.direction,0).css("z-index",10).addClass("prevIndexLi")}d.moveObj[d.direction]=0},moveCallback:function(d){var c=this;c.dbclicks=false;c.loadImg(d)},move:function(){var c=this;if(!c.dbclicks){c.prevIndex=c.wrap.find(".prevIndexLi").index();if(arguments[0]==0){if(!c.isLoop){if(c.index<c.len-1){c.index++}else{clearInterval(c.timer)}}else{c.index<c.len-1?c.index++:c.index=0}if(c.effect!=0){c.moveObj2[c.direction]=-c.step;c.li.eq(c.index).css(c.direction,c.step)}}else{if(arguments[0]==1){if(!c.isLoop&&c.index>0){c.index--}else{if(c.isLoop){c.index<=0?(c.index=c.len-1):c.index--}}if(c.effect!=0){c.moveObj2[c.direction]=c.step;c.li.eq(c.index).css(c.direction,-c.step)}}else{if(c.prevIndex<c.index){c.moveObj2[c.direction]=-c.step;c.effect!=0&&c.li.eq(c.index).css(c.direction,c.step)}else{c.moveObj2[c.direction]=c.step;c.effect!=0&&c.li.eq(c.index).css(c.direction,-c.step)}}}c.li.removeClass("prevIndexLi").eq(c.index).addClass("prevIndexLi");switch(c.effect){case 0:c.li.stop(true,true).fadeOut(c.speed).eq(c.index).fadeIn(c.speed,function(){c.moveCallback(c.index)});c.numBoxB.removeClass(c.cur).eq(c.index).addClass(c.cur);break;case 1:case 2:switch(c.slideType){case 0:c.li.eq(c.prevIndex).stop(true,true).animate(c.moveObj2,c.speed);c.li.eq(c.index).stop(true,true).animate(c.moveObj,c.speed,function(){c.moveCallback(c.index)});break;case 1:c.moving(c.li.eq(c.index),0,arguments[0],function(){c.moveCallback(c.index)});break}c.numBoxB.removeClass(c.cur).eq(c.index).addClass(c.cur);if(c.isLoop&&c.index==c.len){c.numBoxB.removeClass(c.cur).eq(0).addClass(c.cur)}break}if(!c.isLoop){c.prev.removeClass(c.disable[0]);c.next.removeClass(c.disable[1]);c.index==0&&c.prev.addClass(c.disable[0]);c.index==c.len-1&&c.next.addClass(c.disable[1])}}},moving:function(h,c,e,j){var k=this;k.speed=k.speed>200?k.speed:200;var c=parseInt(c),d=0,f=0,g=0,i=0;clearInterval(k.timer2);if(e!=0&&e!=1){if(k.prevIndex<k.index){k.li.not(k.li.eq(k.prevIndex)).css(k.direction,k.step)}else{k.li.not(k.li.eq(k.prevIndex)).css(k.direction,-k.step)}}k.timer2=setInterval(function(){k.direction=="left"&&(g=h[0].offsetLeft);k.direction=="top"&&(g=h[0].offsetTop);f=(c-g)/(k.speed/100);d=f>0?Math.ceil(f):Math.floor(f);if(g==c){clearInterval(k.timer2);h.css(k.direction,g).end().css(k.direction,k.step);j&&typeof j=="function"&&j()}h.css(k.direction,g+d);var l=parseFloat(h.css(k.direction));if(e==0){i=l-k.step}else{if(e==1){i=l+k.step}else{if(k.prevIndex<k.index){i=l-k.step}else{i=l+k.step}}}k.li.eq(k.prevIndex).css(k.direction,i)},30)},loadImg:function(e,g){var d=this;if(d.lazyLoad){var f=d.li.eq(e).find("img");if(f.attr(d.imgSrc)){var c=new Image();c.src=f.attr(d.imgSrc);c.onload=function(){f.attr("src",c.src);f.removeAttr(d.imgSrc);d.li.eq(e).find(".loading-cover").remove();g&&typeof g=="function"&&g()}}}},isLoadJSONFun:function(){var n=this;if(n.isLoadJSON){n.lazyLoad=false;n.wrap.append("<div id='allLoadCover' class='loading-cover' style='z-index:9999999'><p id='loadPercent' class='loadPercent'>00.00%</p></div>");var h=0,l=n.LoadJsonObj.length,m="",k,f=[];for(var g=0;g<l;g++){m+="<li><a href='"+n.LoadJsonObj[g].href+"' target=_blank''><img src='"+n.LoadJsonObj[g].imgSrc+"' alt='"+n.LoadJsonObj[g].imgAlt+"' title='"+n.LoadJsonObj[g].imgTitle+"'></a></li>";f.push(n.LoadJsonObj[g].imgSrc)}n.wrap.prepend("<ul>"+m+"</ul>");n.ul=n.wrap.find("ul");n.li=n.ul.find("li");n.len=n.li.length;n.liWidth=n.li.outerWidth(true);n.liHeight=n.li.outerHeight(true);function d(){k=new Image();k.onload=c;if(h==l-1){k.onload=function(){c();e()}}setTimeout(function(){k.src=f[h]},300)}function c(){var i=(h+1)/l*100;n.wrap.find("#loadPercent").html(i.toFixed(2)+"%");if(h<l-1){h++;d()}}function e(){n.wrap.find("#allLoadCover").remove()}d()}},hotKeyFun:function(){var c=this;if(c.hotKey){document.onkeydown=function(f){var f=f||window.event,d=f.keyCode;if(d==37&&!c.dbclicks){clearInterval(c.timer);!c.isLoop&&c.index!=0&&c.move(1);c.isLoop&&c.move(1);c.dbclicks=true}else{if(d==39&&!c.dbclicks){clearInterval(c.timer);!c.isLoop&&c.index!=c.len-1&&c.move(0);c.isLoop&&c.move(0);c.dbclicks=true}}};document.onkeyup=function(f){var f=f||window.event,d=f.keyCode;if(d==37||d==39){c.autoPlay()}}}},autoPlay:function(){var c=this;clearInterval(c.timer);if(c.isAuto){c.timer=setInterval(function(){c.move(0)},c.autoTime)}},hoverStop:function(d){var c=this;d.hover(function(){clearInterval(c.timer)},function(){c.autoPlay()})},bind:function(){var c=this;c.hoverStop(c.li);if(c.evt==0){c.prev.hide();c.next.hide();var d;c.numBoxB.hover(function(){clearInterval(c.timer);if(!b(this).hasClass(c.cur)){c.index=c.numBoxB.index(this);d=setTimeout(function(){c.move()},200)}},function(){clearTimeout(d);c.autoPlay()})}else{if(c.evt==1){c.hoverStop(c.numBoxB);c.hoverStop(c.prev);c.hoverStop(c.next);c.numBoxB.click(function(){if(!b(this).hasClass(c.cur)){c.index=c.numBoxB.index(this);c.move()}});c.prev.click(function(){if(!b(this).hasClass(c.disable[0])){c.move(1);c.dbclicks=true}});c.next.click(function(){if(!b(this).hasClass(c.disable[1])){c.move(0);c.dbclicks=true}})}}}};b.fn.imageSlide=function(c){var d=b.extend({},b.fn.imageSlide.defaults,c);this.each(function(){new a(b(this),d)})};b.fn.imageSlide.defaults={index:0,ul:"ul",li:"li",numBox:".num",prev:".prev",next:".next",cur:"cur",isAuto:true,lazyLoad:false,imgSrc:"data-src",isLoadJSON:false,LoadJsonObj:[],isLoop:true,disable:["prev-disable","next-disable"],hotKey:true,displayNum:true,evt:1,effect:1,slideType:0,speed:500,autoTime:5000}})(jQuery);